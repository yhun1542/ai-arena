"use strict";(()=>{var a={};a.id=443,a.ids=[443],a.modules={5600:a=>{a.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6472:a=>{a.exports=require("@opentelemetry/api")},8255:(a,b,c)=>{c.r(b),c.d(b,{config:()=>A,default:()=>z,handler:()=>C});var d={};c.r(d),c.d(d,{default:()=>w,runtime:()=>i});var e=c(9046),f=c(8667),g=c(3480),h=c(6435);let i="nodejs",j=[{id:"gpt-4o",name:"GPT-4o",provider:"OpenAI",apiEndpoint:"https://api.openai.com/v1/chat/completions",model:"gpt-4o",specialty:"Ï¢ÖÌï© Î∂ÑÏÑù",icon:"\uD83E\uDD16",color:"#10B981",maxTokens:4096,temperature:.7},{id:"gemini-pro",name:"Gemini Pro",provider:"Google",apiEndpoint:"https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent",model:"gemini-pro",specialty:"Ï∞ΩÏùòÏ†Å ÏÇ¨Í≥†",icon:"\uD83D\uDC8E",color:"#3B82F6",maxTokens:2048,temperature:.8},{id:"claude-3-sonnet",name:"Claude 3 Sonnet",provider:"Anthropic",apiEndpoint:"https://api.anthropic.com/v1/messages",model:"claude-3-sonnet-20240229",specialty:"ÎÖºÎ¶¨Ï†Å Í≤ÄÏ¶ù",icon:"\uD83E\uDDE0",color:"#8B5CF6",maxTokens:4096,temperature:.6},{id:"grok-beta",name:"Grok",provider:"xAI",apiEndpoint:"https://api.x.ai/v1/chat/completions",model:"grok-beta",specialty:"Ïã§Ïö©Ï†Å Ï†ëÍ∑º",icon:"‚ö°",color:"#F59E0B",maxTokens:2048,temperature:.7},{id:"mistral-large",name:"Mistral Large",provider:"Mistral AI",apiEndpoint:"https://api.mistral.ai/v1/chat/completions",model:"mistral-large-latest",specialty:"Ìö®Ïú®ÏÑ± Ï†ÑÎ¨∏Í∞Ä",icon:"\uD83D\uDE80",color:"#EF4444",maxTokens:4096,temperature:.7},{id:"command-r-plus",name:"Command R+",provider:"Cohere",apiEndpoint:"https://api.cohere.ai/v1/chat",model:"command-r-plus",specialty:"Í≤ÄÏÉâ Ï†ÑÎ¨∏Í∞Ä",icon:"\uD83D\uDD0D",color:"#06B6D4",maxTokens:4096,temperature:.7},{id:"llama-3-1",name:"Llama 3.1",provider:"Meta",apiEndpoint:"https://api.llama.com/v1/chat/completions",model:"llama-3.1-70b-instruct",specialty:"ÏΩîÎî© Ï†ÑÎ¨∏Í∞Ä",icon:"\uD83E\uDD99",color:"#8B5A2B",maxTokens:4096,temperature:.5},{id:"perplexity-online",name:"Perplexity AI",provider:"Perplexity",apiEndpoint:"https://api.perplexity.ai/chat/completions",model:"llama-3.1-sonar-large-128k-online",specialty:"Ìå©Ìä∏Ï≤¥ÌÇπ Ï†ÑÎ¨∏Í∞Ä",icon:"\uD83D\uDCCA",color:"#7C3AED",maxTokens:4096,temperature:.6}];async function k(a,b,c){let d=Date.now();try{var e,f,g,h;let i,j="";switch(a.provider){case"OpenAI":i=await l(a,b,c.OPENAI_API_KEY),j=i.choices[0]?.message?.content||"";break;case"Google":i=await m(a,b,c.GEMINI_API_KEY),j=i.candidates[0]?.content?.parts[0]?.text||"";break;case"Anthropic":i=await n(a,b,c.ANTHROPIC_API_KEY),j=i.content[0]?.text||"";break;case"xAI":i=await o(a,b,c.XAI_API_KEY),j=i.choices[0]?.message?.content||"";break;case"Mistral AI":i=await p(a,b,c.MISTRAL_API_KEY),j=i.choices[0]?.message?.content||"";break;case"Cohere":j=(i=await q(a,b,c.COHERE_API_KEY)).text||"";break;case"Meta":i=await r(a,b,c.LLAMA_API_KEY),j=i.choices[0]?.message?.content||"";break;case"Perplexity":i=await s(a,b,c.PERPLEXITY_API_KEY),j=i.choices[0]?.message?.content||"";break;default:throw Error(`Unsupported provider: ${a.provider}`)}let k=Date.now()-d;return{modelId:a.id,content:j,score:(e=j,f=a.specialty,Math.round(Math.min(90+10*Math.random(),100)+Math.min(e.length/100,5))),processingTime:k,confidence:function(a){let b=Math.min(a.length/500,1);return Math.round((b+(a.includes("##")||a.includes("**")?.2:0))*100)}(j),strengths:function(a,b){let c=[b];return a.includes("Î∂ÑÏÑù")&&c.push("Ï≤¥Í≥ÑÏ†Å Î∂ÑÏÑù"),a.includes("Ï∞ΩÏùò")&&c.push("Ï∞ΩÏùòÏ†Å Ï†ëÍ∑º"),a.includes("ÎÖºÎ¶¨")&&c.push("ÎÖºÎ¶¨Ï†Å ÏÇ¨Í≥†"),a.includes("Ïã§Ïö©")&&c.push("Ïã§Ïö©Ï†Å Ìï¥Í≤∞"),c.slice(0,3)}(j,a.specialty),concerns:function(a){let b=[];return a.length<200&&b.push("ÏùëÎãµ Í∏∏Ïù¥ Î∂ÄÏ°±"),a.includes("##")||a.includes("**")||b.push("Íµ¨Ï°∞Ìôî Î∂ÄÏ°±"),a.includes("ÌôïÏã§ÌïòÏßÄ Ïïä")&&b.push("Î∂àÌôïÏã§ÏÑ±"),b.slice(0,2)}(j),metadata:{tokenCount:t(j),cost:(g=a,h=j,t(h)*(({"gpt-4o":3e-5,"gemini-pro":125e-6,"claude-3-sonnet":15e-6,"grok-beta":2e-5,"mistral-large":8e-6,"command-r-plus":3e-5,"llama-3-1":1e-6,"perplexity-online":2e-5})[g.id]||1e-5))}}}catch(b){return console.error(`Error calling ${a.name}:`,b),{modelId:a.id,content:`${a.name} ÏùëÎãµÏùÑ Î∞õÏùÑ Ïàò ÏóÜÏäµÎãàÎã§: ${b instanceof Error?b.message:"Unknown error"}`,score:0,processingTime:Date.now()-d,confidence:0,strengths:[],concerns:["API Ìò∏Ï∂ú Ïã§Ìå®"],metadata:{tokenCount:0,cost:0}}}}async function l(a,b,c){let d=await fetch(a.apiEndpoint,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`},body:JSON.stringify({model:a.model,messages:[{role:"user",content:b}],max_tokens:a.maxTokens,temperature:a.temperature})});if(!d.ok)throw Error(`OpenAI API error: ${d.status}`);return d.json()}async function m(a,b,c){let d=await fetch(`${a.apiEndpoint}?key=${c}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:b}]}],generationConfig:{maxOutputTokens:a.maxTokens,temperature:a.temperature}})});if(!d.ok)throw Error(`Gemini API error: ${d.status}`);return d.json()}async function n(a,b,c){let d=await fetch(a.apiEndpoint,{method:"POST",headers:{"Content-Type":"application/json","x-api-key":c,"anthropic-version":"2023-06-01"},body:JSON.stringify({model:a.model,max_tokens:a.maxTokens,temperature:a.temperature,messages:[{role:"user",content:b}]})});if(!d.ok)throw Error(`Claude API error: ${d.status}`);return d.json()}async function o(a,b,c){let d=await fetch(a.apiEndpoint,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`},body:JSON.stringify({model:a.model,messages:[{role:"user",content:b}],max_tokens:a.maxTokens,temperature:a.temperature})});if(!d.ok)throw Error(`Grok API error: ${d.status}`);return d.json()}async function p(a,b,c){let d=await fetch(a.apiEndpoint,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`},body:JSON.stringify({model:a.model,messages:[{role:"user",content:b}],max_tokens:a.maxTokens,temperature:a.temperature})});if(!d.ok)throw Error(`Mistral API error: ${d.status}`);return d.json()}async function q(a,b,c){let d=await fetch(a.apiEndpoint,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`},body:JSON.stringify({model:a.model,message:b,max_tokens:a.maxTokens,temperature:a.temperature})});if(!d.ok)throw Error(`Cohere API error: ${d.status}`);return d.json()}async function r(a,b,c){let d=await fetch(a.apiEndpoint,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`},body:JSON.stringify({model:a.model,messages:[{role:"user",content:b}],max_tokens:a.maxTokens,temperature:a.temperature})});if(!d.ok)throw Error(`Llama API error: ${d.status}`);return d.json()}async function s(a,b,c){let d=await fetch(a.apiEndpoint,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`},body:JSON.stringify({model:a.model,messages:[{role:"user",content:b}],max_tokens:a.maxTokens,temperature:a.temperature})});if(!d.ok)throw Error(`Perplexity API error: ${d.status}`);return d.json()}function t(a){return Math.ceil(a.length/4)}async function u(a,b,c,d){return Promise.all(a.map(a=>Promise.race([k(a,b,c),new Promise((a,b)=>setTimeout(()=>b(Error("Timeout")),d))]).catch(b=>({modelId:a.id,content:`ÌÉÄÏûÑÏïÑÏõÉ ÎòêÎäî Ïò§Î•ò: ${b.message}`,score:0,processingTime:d,confidence:0,strengths:[],concerns:["ÌÉÄÏûÑÏïÑÏõÉ"],metadata:{tokenCount:0,cost:0}}))))}async function v(a,b,c,d){let e=[...a],f=[];for(let a=0;a<d&&e.length>1;a++){let a=await u(e,b,c,3e4);f.push(...a),a.sort((a,b)=>b.score-a.score);let d=Math.max(1,Math.ceil(e.length/2)),g=a.slice(0,d).map(a=>a.modelId);e=e.filter(a=>g.includes(a.id))}return f}async function w(a,b){if(b.setHeader("Access-Control-Allow-Origin","*"),b.setHeader("Access-Control-Allow-Methods","GET, POST, OPTIONS"),b.setHeader("Access-Control-Allow-Headers","Content-Type"),"OPTIONS"===a.method)return b.status(200).end();if("POST"!==a.method)return b.status(405).json({error:"Method Not Allowed",message:"Only POST requests are supported"});try{let{query:c,config:d={mode:"parallel",selectedModels:["gpt-4o","gemini-pro","claude-3-sonnet","grok-beta"],rounds:1,votingEnabled:!1,timeoutMs:3e4,maxConcurrency:8}}=a.body;if(!c||"string"!=typeof c)return b.status(400).json({error:"Invalid Input",message:"Query is required and must be a string"});if(c.length<10||c.length>2e3)return b.status(400).json({error:"Invalid Query Length",message:"Query must be between 10 and 2000 characters"});let e={OPENAI_API_KEY:process.env.OPENAI_API_KEY||"",GEMINI_API_KEY:process.env.GEMINI_API_KEY||"",ANTHROPIC_API_KEY:process.env.ANTHROPIC_API_KEY||"",XAI_API_KEY:process.env.XAI_API_KEY||"",MISTRAL_API_KEY:process.env.MISTRAL_API_KEY||"",COHERE_API_KEY:process.env.COHERE_API_KEY||"",LLAMA_API_KEY:process.env.LLAMA_API_KEY||"",PERPLEXITY_API_KEY:process.env.PERPLEXITY_API_KEY||""},f=j.filter(a=>d.selectedModels?.includes(a.id));if(0===f.length)return b.status(400).json({error:"No Valid Models",message:"At least one valid model must be selected"});console.log(`üé≠ AI Orchestra ÏöîÏ≤≠:`,{mode:d.mode,models:f.map(a=>a.name),queryLength:c.length,timestamp:new Date().toISOString()});let g=Date.now(),h=[];switch(d.mode){case"parallel":case"debate":case"consensus":default:h=await u(f,c,e,d.timeoutMs||3e4);break;case"tournament":h=await v(f,c,e,d.rounds||2)}let i=Date.now()-g;h.sort((a,b)=>b.score-a.score);let k={orchestration:{mode:d.mode,totalModels:f.length,successfulResponses:h.filter(a=>a.score>0).length,averageScore:h.reduce((a,b)=>a+b.score,0)/h.length,totalCost:h.reduce((a,b)=>a+b.metadata.cost,0),processingTime:`${(i/1e3).toFixed(1)}Ï¥à`},responses:h.map(a=>({model:f.find(b=>b.id===a.modelId),response:a})),summary:{winner:h[0]?.modelId||"none",consensus:h.filter(a=>a.score>85).length>h.length/2,topInsights:h.filter(a=>a.score>80).slice(0,3).map(a=>a.content.substring(0,200)+"...")}};return b.status(200).json({success:!0,data:k,metadata:{requestId:`orchestra-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,timestamp:new Date().toISOString(),version:"2.0.0"}})}catch(a){return console.error("‚ùå AI Orchestra Ïò§Î•ò:",a),b.status(500).json({error:"Internal Server Error",message:"Ïò§ÏºÄÏä§Ìä∏Î†àÏù¥ÏÖò Ï≤òÎ¶¨ Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.",code:"ORCHESTRA_ERROR",timestamp:new Date().toISOString()})}}var x=c(8112),y=c(8766);let z=(0,h.M)(d,"default"),A=(0,h.M)(d,"config"),B=new g.PagesAPIRouteModule({definition:{kind:f.A.PAGES_API,page:"/api/synapse-mega",pathname:"/api/synapse-mega",bundlePath:"",filename:""},userland:d,distDir:".next",relativeProjectDir:""});async function C(a,b,c){let d=await B.prepare(a,b,{srcPage:"/api/synapse-mega"});if(!d){b.statusCode=400,b.end("Bad Request"),null==c.waitUntil||c.waitUntil.call(c,Promise.resolve());return}let{query:f,params:g,prerenderManifest:h,routerServerContext:i}=d;try{let c=a.method||"GET",d=(0,x.getTracer)(),e=d.getActiveScopeSpan(),j=B.instrumentationOnRequestError.bind(B),k=async e=>B.render(a,b,{query:{...f,...g},params:g,allowedRevalidateHeaderKeys:[],multiZoneDraftMode:!1,trustHostHeader:!1,previewProps:h.preview,propagateError:!1,dev:B.isDev,page:"/api/synapse-mega",internalRevalidate:null==i?void 0:i.revalidate,onError:(...b)=>j(a,...b)}).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":b.statusCode,"next.rsc":!1});let f=d.getRootSpanAttributes();if(!f)return;if(f.get("next.span_type")!==y.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${f.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let g=f.get("next.route");if(g){let a=`${c} ${g}`;e.setAttributes({"next.route":g,"http.route":g,"next.span_name":a}),e.updateName(a)}else e.updateName(`${c} ${a.url}`)});e?await k(e):await d.withPropagatedContext(a.headers,()=>d.trace(y.BaseServerSpan.handleRequest,{spanName:`${c} ${a.url}`,kind:x.SpanKind.SERVER,attributes:{"http.method":c,"http.target":a.url}},k))}catch(a){if(B.isDev)throw a;(0,e.sendError)(b,500,"Internal Server Error")}finally{null==c.waitUntil||c.waitUntil.call(c,Promise.resolve())}}}};var b=require("../../webpack-api-runtime.js");b.C(a);var c=b.X(0,[169],()=>b(b.s=8255));module.exports=c})();