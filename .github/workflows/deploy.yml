name: Deploy

on:
  push:
      branches: [ main ]
        pull_request:
            branches: [ main ]
              workflow_dispatch:

              jobs:
                deploy:
                    runs-on: ubuntu-latest
                        steps:
                              - uses: actions/checkout@v4
                                    - uses: actions/setup-node@v4
                                            with: 
                                                      node-version: 20
                                                                cache: 'pnpm'
                                                                      - run: corepack enable
                                                                            - run: pnpm install --frozen-lockfile
                                                                                  - run: pnpm run build
                                                                                        - uses: manus-ai/action@v1
                                                                                                with:
                                                                                                          token: ${{ secrets.MANUS_TOKEN }}
                                                                                                                    org-id: ${{ secrets.VERCEL_ORG_ID }}
                                                                                                                              project-id: ${{ secrets.VERCEL_PROJECT_ID }}
                                                                                                                              
                                                                                                                                notify:
                                                                                                                                    needs: deploy
                                                                                                                                        if: always()
                                                                                                                                            uses: ./.github/workflows/_notify.yml
                                                                                                                                                with:
                                                                                                                                                      job_name: deploy
                                                                                                                                                            job_status: ${{ needs.deploy.result }}
                                                                                                                                                                secrets: inherit
